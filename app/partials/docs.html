<!DOCTYPE html>  <html> <head>   <title>angular-kendo.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               angular-kendo.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">angular</span><span class="p">,</span> <span class="nx">$</span><span class="p">,</span> <span class="nx">kendo</span><span class="p">)</span> <span class="p">{</span>
  </pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Use strict mode because it's totally hip.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
  </pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Create directives and services modules.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">directives</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;kendo.directives&#39;</span><span class="p">,</span> <span class="p">[]);</span>
  <span class="kd">var</span> <span class="nx">services</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;kendo.services&#39;</span><span class="p">,</span> <span class="p">[]);</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Create a new kendo module and pass in the directives and services</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">main</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">&#39;kendo&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;kendo.directives&#39;</span><span class="p">,</span> <span class="s1">&#39;kendo.services&#39;</span><span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Iterate over the kendo.ui and kendo.dataviz.ui namespace objects to get the Kendo UI widgets adding
them to the 'widgets' array. </p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">var</span> <span class="nx">widgets</span> <span class="o">=</span> <span class="p">[];</span>

  <span class="nx">angular</span><span class="p">.</span><span class="nx">forEach</span><span class="p">([</span><span class="nx">kendo</span><span class="p">.</span><span class="nx">ui</span><span class="p">,</span> <span class="nx">kendo</span><span class="p">.</span><span class="nx">dataviz</span> <span class="o">&amp;&amp;</span> <span class="nx">kendo</span><span class="p">.</span><span class="nx">dataviz</span><span class="p">.</span><span class="nx">ui</span><span class="p">],</span> <span class="kd">function</span><span class="p">(</span><span class="nx">namespace</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">angular</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">namespace</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>add all widgets</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">if</span><span class="p">(</span> <span class="nx">key</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^[A-Z]/</span><span class="p">)</span> <span class="p">){</span>
        <span class="nx">widgets</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s2">&quot;kendo&quot;</span> <span class="o">+</span> <span class="nx">key</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">});</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Set up a value service containing the names of available Kendo UI Widgets.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">services</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="s1">&#39;kendoWidgets&#39;</span><span class="p">,</span> <span class="nx">widgets</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Loop through the array of widget names and dynamically create a directive for each one.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">angular</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span> <span class="nx">widgets</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">kendoWidget</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">directives</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="nx">kendoWidget</span><span class="p">,</span> <span class="p">[</span> <span class="s1">&#39;$parse&#39;</span><span class="p">,</span> <span class="s1">&#39;$timeout&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$parse</span><span class="p">,</span> <span class="nx">$timeout</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Parse the directive for attributes, elements and classes.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">restrict</span><span class="o">:</span> <span class="s1">&#39;ACE&#39;</span><span class="p">,</span>
            <span class="nx">transclude</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">require</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;?ngModel&#39;</span><span class="p">,</span> <span class="nx">kendoWidget</span><span class="p">],</span>
            <span class="nx">controller</span><span class="o">:</span> <span class="p">[</span> <span class="s1">&#39;$scope&#39;</span><span class="p">,</span> <span class="s1">&#39;$attrs&#39;</span><span class="p">,</span> <span class="s1">&#39;$element&#39;</span><span class="p">,</span> <span class="s1">&#39;$transclude&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$attrs</span><span class="p">,</span> <span class="nx">$element</span><span class="p">,</span> <span class="nx">$transclude</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Make the element's contents available to the kendo widget to allow creating some widgets from existing elements.</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="nx">$transclude</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">clone</span><span class="p">){</span>
                <span class="nx">$element</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">clone</span><span class="p">);</span>
              <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>TODO: add functions to allow other directives to register option decorators</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="p">}],</span>
            <span class="nx">link</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">ctrls</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Widgets may be bound to the ng-model.</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="kd">var</span> <span class="nx">ngModel</span> <span class="o">=</span> <span class="nx">ctrls</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                  <span class="nx">widget</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Bind kendo widget to element only once interpolation on attributes is done.</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="nx">$timeout</span><span class="p">(</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>create the kendo widget and bind it to the element.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="nx">widget</span> <span class="o">=</span> <span class="nx">createWidget</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">ctrls</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>if kendo-refresh attribute is provided, rebind the kendo widget when 
the watched value changes</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span><span class="p">(</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">kendoRefresh</span> <span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>watch for changes on the expression passed in the kendo-refresh attribute</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="nx">attrs</span><span class="p">.</span><span class="nx">kendoRefresh</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newValue</span><span class="p">,</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span><span class="p">(</span><span class="nx">newValue</span> <span class="o">!==</span> <span class="nx">oldValue</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>create the kendo widget and bind it to the element.</p>             </td>             <td class="code">               <div class="highlight"><pre>                            <span class="nx">widget</span> <span class="o">=</span> <span class="nx">createWidget</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">ctrls</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
                        <span class="p">}</span>
                    <span class="p">},</span> <span class="kc">true</span><span class="p">);</span> <span class="c1">// watch for object equality. Use native or simple values.</span>
                <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Cleanup after ourselves</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="nx">scope</span><span class="p">.</span><span class="nx">$on</span><span class="p">(</span> <span class="s1">&#39;$destroy&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                  <span class="nx">widget</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
                <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>if ngModel is on the element, we setup bi-directional data binding</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">if</span> <span class="p">(</span><span class="nx">ngModel</span><span class="p">)</span> <span class="p">{</span>
                  <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nx">widget</span><span class="p">.</span><span class="nx">value</span> <span class="p">)</span> <span class="p">{</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;ng-model used but &#39;</span> <span class="o">+</span> <span class="nx">kendoWidget</span> <span class="o">+</span> <span class="s1">&#39; does not define a value accessor&#39;</span><span class="p">);</span>
                  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Angular will invoke $render when the view needs to be updated with the view value.</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="nx">ngModel</span><span class="p">.</span><span class="nx">$render</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Update the widget with the view value.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">widget</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="nx">ngModel</span><span class="p">.</span><span class="nx">$viewValue</span><span class="p">);</span>
                  <span class="p">};</span>
                  </pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>In order to be able to update the angular scope objects, we need to know when the change event is fired for a Kendo UI Widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="nx">widget</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Set the value on the scope to the widget value. </p>             </td>             <td class="code">               <div class="highlight"><pre>                      <span class="nx">ngModel</span><span class="p">.</span><span class="nx">$setViewValue</span><span class="p">(</span><span class="nx">widget</span><span class="p">.</span><span class="nx">value</span><span class="p">());</span>
                    <span class="p">});</span>
                  <span class="p">});</span>
                <span class="p">}</span>
              <span class="p">});</span>           
            <span class="p">}</span>
          <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Create the kendo widget with gathered options</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="kd">function</span> <span class="nx">createWidget</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">controller</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Create the options object</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">gatherOptions</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">controller</span><span class="p">);</span>
                </pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Bind the kendo widget to the element and return a reference to the widget.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="k">return</span> <span class="nx">element</span><span class="p">[</span><span class="nx">kendoWidget</span><span class="p">](</span><span class="nx">options</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="nx">kendoWidget</span><span class="p">);</span>
          <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Gather the options from defaults and from attributes</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="kd">function</span> <span class="nx">gatherOptions</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">element</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">,</span> <span class="nx">controller</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>TODO: add kendoDefaults value service and use it to get a base options object?
var options = kendoDefaults[kendoWidget];</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">dataSource</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>make a deep clone of the options object passed to the directive, if any.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="kd">var</span> <span class="nx">options</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">copy</span><span class="p">(</span><span class="nx">scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">kendoWidget</span><span class="p">]))</span> <span class="o">||</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Mixin the data that's set on the element in the options</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">angular</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span> <span class="nx">element</span><span class="p">.</span><span class="nx">data</span><span class="p">(),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Only add data items that were put as attributes since some items put by angular and kendo
may have circular references and Kendo's deepCopyOne doesn't like that.</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="k">if</span><span class="p">(</span> <span class="o">!!</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span><span class="p">(</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">isObject</span><span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Because this may be invoked on refresh (kendo-refresh) and that kendo may 
have modified the object put in the element's data,
we are parsing the attribute value to get the inital value of the object
and not the potentially modified one. </p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="nx">options</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">attrs</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Natives are immutable so we can just put them in.</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="nx">options</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
                <span class="p">}</span>
              <span class="p">}</span>
            <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>If no dataSource was provided, </p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">if</span><span class="p">(</span> <span class="o">!</span><span class="nx">options</span><span class="p">.</span><span class="nx">dataSource</span> <span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>Check if one was set in the element's data or in its ancestors.</p>             </td>             <td class="code">               <div class="highlight"><pre>              <span class="nx">dataSource</span> <span class="o">=</span> <span class="nx">element</span><span class="p">.</span><span class="nx">inheritedData</span><span class="p">(</span><span class="s1">&#39;$kendoDataSource&#39;</span><span class="p">);</span>
              <span class="k">if</span><span class="p">(</span> <span class="nx">dataSource</span> <span class="p">)</span> <span class="p">{</span>
                <span class="nx">options</span><span class="p">.</span><span class="nx">dataSource</span> <span class="o">=</span> <span class="nx">dataSource</span><span class="p">;</span>
              <span class="p">}</span>
            <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Add on-* event handlers to options.</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">addEventHandlers</span><span class="p">(</span><span class="nx">options</span><span class="p">,</span> <span class="nx">scope</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>TODO: invoke controller.decorateOptions to allow other directives (or directive extensions)
      to modify the options before they get bound. This would provide an extention point for directives
      that require special processing like compiling nodes generated by kendo so that angular data binding
      can happen in kendo widget templates for example.
controller.decorateOptions(options);</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="k">return</span> <span class="nx">options</span><span class="p">;</span>

          <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>Create an event handler function for each on-* attribute on the element and add to dest.</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="kd">function</span> <span class="nx">addEventHandlers</span><span class="p">(</span><span class="nx">dest</span><span class="p">,</span> <span class="nx">scope</span><span class="p">,</span> <span class="nx">attrs</span><span class="p">)</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">memo</span><span class="p">,</span>
                <span class="nx">eventHandlers</span> <span class="o">=</span> <span class="nx">reduce</span><span class="p">(</span><span class="nx">attrs</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">memo</span><span class="p">,</span> <span class="nx">attValue</span><span class="p">,</span> <span class="nx">att</span><span class="p">)</span> <span class="p">{</span>
              <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">att</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/^on(.+)/</span><span class="p">),</span> <span class="nx">eventName</span><span class="p">,</span> <span class="nx">fn</span><span class="p">;</span>
              <span class="k">if</span><span class="p">(</span> <span class="nx">match</span> <span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Lowercase the first letter to match the event name kendo expects.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="nx">eventName</span> <span class="o">=</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">charAt</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">+</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Parse the expression.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="nx">fn</span> <span class="o">=</span> <span class="nx">$parse</span><span class="p">(</span><span class="nx">attValue</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Add a kendo event listener to the memo.</p>             </td>             <td class="code">               <div class="highlight"><pre>                <span class="nx">memo</span><span class="p">[</span><span class="nx">eventName</span><span class="p">]</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Make sure this gets invoked in the angularjs lifecycle.</p>             </td>             <td class="code">               <div class="highlight"><pre>                  <span class="nx">scope</span><span class="p">.</span><span class="nx">$apply</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Invoke the parsed expression with a kendoEvent local that the expression can use.</p>             </td>             <td class="code">               <div class="highlight"><pre>                    <span class="nx">fn</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="p">{</span><span class="nx">kendoEvent</span><span class="o">:</span> <span class="nx">e</span><span class="p">});</span>
                  <span class="p">});</span>
                <span class="p">};</span>
              <span class="p">}</span>
              <span class="k">return</span> <span class="nx">memo</span><span class="p">;</span>
            <span class="p">},</span> <span class="p">{});</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>mix the eventHandlers in the options object</p>             </td>             <td class="code">               <div class="highlight"><pre>            <span class="nx">angular</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">dest</span><span class="p">,</span> <span class="nx">eventHandlers</span><span class="p">);</span>
          <span class="p">}</span>

      <span class="p">}]</span> <span class="p">);</span>
  <span class="p">});</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <h2>The kendoSource directive allows setting the Kendo UI DataSource of a widget directly from the HTML.</h2>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">directives</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">&#39;kendoSource&#39;</span><span class="p">,</span> <span class="p">[</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>This is an attribute directive</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">restrict</span><span class="o">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
      <span class="nx">controller</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;$scope&#39;</span><span class="p">,</span> <span class="s1">&#39;$attrs&#39;</span><span class="p">,</span> <span class="s1">&#39;$element&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$attrs</span><span class="p">,</span> <span class="nx">$element</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>Set $kendoDataSource in the element's data. 3rd parties can define their own dataSource creation
directive and provide this data on the element.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$element</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;$kendoDataSource&#39;</span><span class="p">,</span> <span class="nx">toDataSource</span><span class="p">(</span><span class="nx">$scope</span><span class="p">.</span><span class="nx">$eval</span><span class="p">(</span><span class="nx">$attrs</span><span class="p">.</span><span class="nx">kendoSource</span><span class="p">)));</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>Keep the element's data up-to-date with changes.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">$scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span><span class="nx">$attrs</span><span class="p">.</span><span class="nx">kendoSource</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">newDS</span><span class="p">,</span> <span class="nx">oldDS</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">if</span><span class="p">(</span> <span class="nx">newDS</span> <span class="o">!==</span> <span class="nx">oldDS</span> <span class="p">)</span> <span class="p">{</span>
            <span class="nx">$element</span><span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s1">&#39;$kendoDataSource&#39;</span><span class="p">,</span> <span class="nx">toDataSource</span><span class="p">(</span><span class="nx">newDS</span><span class="p">));</span>
          <span class="p">}</span>
        <span class="p">});</span>
      <span class="p">}]</span>
        
    <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Transforms the object into a Kendo UI DataSource.</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">function</span> <span class="nx">toDataSource</span><span class="p">(</span><span class="nx">ds</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>TODO: if ds is a $resource, wrap it in a kendo dataSource using an injected service</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">return</span> <span class="nx">kendo</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">DataSource</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">ds</span><span class="p">);</span>
    <span class="p">}</span>

  <span class="p">}]);</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Simplistic reduce function</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="kd">function</span> <span class="nx">reduce</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">cb</span><span class="p">,</span> <span class="nx">memo</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">angular</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">memo</span> <span class="o">=</span> <span class="nx">cb</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">value</span><span class="p">,</span> <span class="nx">memo</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">key</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">return</span> <span class="nx">memo</span><span class="p">;</span>
  <span class="p">}</span>

<span class="p">})(</span><span class="nx">angular</span><span class="p">,</span> <span class="nx">jQuery</span><span class="p">,</span> <span class="nx">kendo</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 